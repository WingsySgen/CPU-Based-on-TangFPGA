### 基于Sipeed Tang Nano 9k/20k的简易CPU v1

**-----Coming Soon-----**

#### 简介

基于Tang Nano 9k/20k的简易CPU。定长指令，哈佛结构，单周期设计。目前仅支持8bit。

可接任意IO，所有IO都被连接到一块IO控制模块上映射到一个寄存器中。已支持UART。SPI和I2C正在测试。

使用Verilog在Tang FPGA上实现CPU。使用任意文本编辑器写适用于该CPU的汇编命令，然后使用C++进行从汇编到比特流的映射，写到Verilog的Gowin IP核初始化文件中烧入FPGA。

请注意到目前为止该CPU尚未实装中断系统，会尽快实装。



#### 使用方法

前置知识：C++、数字电子技术、Verilog、计算机组成（微机原理、接口技术）等。

你需要高云云源IDE来开发Sipeed Tang，以及一个C++11以上的开发环境。

如果你只需要需要一个能工作在FPGA上，但可以不像RISC-V那样专业的软核，作为一个简易的实现，你可以仅仅了解如何通过**指令集**让这块CPU工作即可。



#### CPU结构简介

该CPU设计如下：

 1. 存在三条总线，#A、#B两条用来提供计算输入/寄存器输出，#C用来提供计算输出/寄存器输入；

 2. 共有16个寄存器，其中#0到#11作为通用寄存器。#12被称作IOAD，#13被称作IOC，#14被称作Timer，#15被称作PC。寄存器会从#C上获取数据，会将数据输出到#A或#B上。

    (1) IOC是输入输出控制模块，该模块被封装为寄存器，其行为对于CPU而言与普通寄存器相同，用来对不同IO进行管理。

    (2) IOAD用来区分当前选中的IO模块，具体而言，IOAD低四位用来指示可能存在的IO内部寄存器地址，其它高位用来指示当前选中的IO。

    (3) Timer是定时器寄存器，寄存器中的值会不断自增，从0开始自增256次后到下一次0所用时间需要0.99999289s，同1s比误差小于1e-5。是在不使用中断时感知时间的一种手段。

    (4) PC是程序计数器。

 3. RAM、ROM使用Tang上的BSRAM实现。指令存在ROM中，定长32bit；

 4. ALU以及COND负责计算以及条件判断，会从#A和#B获取数据，其中ALU把计算结果输出到#C。



#### 常量与指令集

见 `/指令集_ISA/常量与指令集.md`



#### 其它

推荐游戏《Turing Complete》，steam在售。教玩家从一个与非门开始搓出一整套计算机并使用汇编实现一些功能，贯穿了从数电基础开始到计算机组成的知识点。

实际上该项目最初的实现就是由我在《Turing Complete》中实现的CPU发展而来。并用在了2023年年初西南科技大学开设的处理器项目设计中。

